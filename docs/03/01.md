# 1. 엔티티 매니저 팩토리와 엔티티 매니저

- 데이터베이스를 하나만 사용하는 애플리케이션은 일반적으로 `EntityManagerFactory` 하나만 생성한다.
- `META-INF/persistence.xml`에 있는 정보를 바탕으로 생성한다.
- 필요할 때마다 `EntityManagerFactory`를 통해 엔티티 매니저를 생성하면 된다.
- 엔티티 매니저 팩토리는 비용은 상당하여 한 개를 애플리케이션 전체에서 공유하지만 엔티티 매니저는 비용이 거의 들지 않는다.
- 엔티티 매니저 팩토리는 여러 스레드가 접근해도 안전하지만 엔티티 매니저는 동시성 문제가 발생한다.
- 엔티티 매니저는 데이터베이스 연결이 꼭 필요한 시점까지 커넥션을 얻지 않는다. 보통 트랜잭션을 시작할 때 얻는다.
- JPA 구현체들은 `EntityManagerFactory`를 생성할 때 커넥션 풀도 만드는데 J2SE 환경에서 사용하는 방법이다.
- JPA를 J2EE 환경(스프링 프레임워크 포함)에서 사용하면 해당 컨테이너가 제공하는 데이터소스를 사용한다.

---

- J2SE: 일반적인 자바 환경. Swing, JWT 등을 포함한다.
- J2EE: 엔터프라이즈 자바 환경. Servlet, JSP, EJB 등을 포함한다.

-----
[Home](./index.md)
